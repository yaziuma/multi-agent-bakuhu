# 伝令1専用タスクファイル
task:
  task_id: denrei_gunshi_cmd054b
  parent_cmd: cmd_054
  priority: high
  description: |
    軍師（Codex）にマークダウンセクション抽出スクリプトの **awk版** を依頼せよ。

    ## 背景
    前回の依頼でPython版が返ってきたが、殿の方針により却下。
    本プロジェクト（multi-agent-bakuhu）はpublicリポジトリであり、
    **Linux標準ツール（bash + awk/sed/grep + coreutils）のみ**で実装すること。
    Pythonは不可。

    ## 要件（前回と同じ）
    マークダウンファイルから見出しを指定してそのセクション全体を抽出する。

    ### 動作仕様
    1. 指定した見出し行を検索する
    2. その見出しの開始から、同レベル以上の次の見出しの直前までを返す
    3. 配下の子見出しは全て含む
    4. `---` は特別扱いしない。ただのテキスト
    5. 見出しレベルは `#` の数で判定

    ### 技術制約（厳守）
    - **bash + awk のみ**。Python/Perl/Ruby等の言語は一切使用不可
    - POSIX互換を意識（gawk拡張は最小限に）
    - シェバン: `#!/bin/bash` or `#!/usr/bin/env bash`
    - 外部パッケージのインストール一切不要

    ## Codex CLI コマンド（軍師召喚）

    ```bash
    codex exec --model gpt-5.2-codex --sandbox read-only --full-auto "Design and write a bash script that extracts a markdown section by heading. CRITICAL: Use ONLY bash + awk. NO Python, NO Perl, NO Ruby.

    ## Requirements
    - Input: a markdown file path and a heading text (e.g. '## Section Title')
    - Output: the full content of that section, from the heading line to just before the next heading of the same or higher level
    - Child headings are included (e.g. specifying '##' includes all '###' under it)
    - '---' horizontal rules are NOT treated as section boundaries, just plain text
    - Heading level is determined by counting '#' characters
    - A heading line must have a space after the '#' characters (e.g. '## Foo' is a heading, '##Foo' is not)

    ## Technical Constraints (STRICT)
    - bash + awk ONLY. No Python, Perl, Ruby, or any scripting language
    - POSIX-compatible awk preferred (minimize gawk extensions)
    - Shebang: #!/usr/bin/env bash
    - No external package installation
    - Must handle: heading not found (exit 1), section at end of file (output to EOF), Unicode/emoji in headings

    ## Deliverables
    1. Complete bash script using awk for the parsing logic
    2. Usage examples
    3. Edge case handling notes

    Do not include thinking process. Output only the final result." 2>/dev/null > /home/quieter/projects/multi-agent-bakuhu/queue/gunshi/reports/report_cmd_054_md_section_extract_awk.md
    ```

    ## 結果保存先
    - queue/gunshi/reports/report_cmd_054_md_section_extract_awk.md

    ## 完了後
    1. 報告YAMLを作成: queue/denrei/reports/denrei1_report.yaml
    2. 家老ペイン (multiagent:agents.0) に send-keys で報告

  external_agent: gunshi
  status: done
  timestamp: "2026-02-06T16:00:00"
