承知いたしました。OpenAI Codex CLIに関する調査報告書を以下にまとめます。

---

# OpenAI Codex CLI 総合報告書

## 1. Codex CLIとは何か

OpenAI Codex CLI（`@openai/codex`）は、OpenAIが公式に提供するオープンソースのコマンドラインインターフェース（CLI）ツールです。開発者のローカルマシン上で動作する軽量なコーディングエージェントとして機能し、OpenAIの高度な推論モデルをターミナルに直接統合します。

### 目的と特徴

- **開発支援**: 機能開発、バグ修正、リファクタリング、テスト作成・実行、不慣れなコードの理解など、開発ワークフロー全般を支援することを目的とします。
- **ローカル実行**: ツールはローカルで実行されるため、ソースコードが外部に送信されることなく、セキュリティが確保されます。
- **マルチモーダル入力**: テキストプロンプトだけでなく、スクリーンショットや図などの画像情報を入力としてコードを生成・編集する能力を持ちます。
- **ワークフロー統合**: ファイルの直接編集、シェルコマンドの実行、マイグレーション設定、ファイルの一括リネームなど、ローカル開発環境に深く統合された操作が可能です。
- **安全な実行**: ユーザーの承認に基づき変更を提案するモードから、完全自動化モードまで複数の実行モードを提供します。また、システムを保護するためのサンドボックス機能やセキュリティ対策が組み込まれています。

## 2. インストール方法

### 環境要件
- Node.js

### セットアップ手順
1.  **インストール**: `npm`（Node.jsのパッケージマネージャ）を使い、グローバルにインストールします。
    ```bash
    npm install -g @openai/codex
    ```

2.  **API Keyと認証**: Codex CLIはChatGPTアカウントと連携して認証を行います。インストール後、以下のコマンドを実行するとブラウザが起動し、ChatGPTアカウントでのログインと認証を求められます。
    ```bash
    codex login
    ```
    認証情報（APIキーを含む）はローカルに保存され、以降のコマンドで利用されます。利用には、APIアクセスが有効なChatGPTのプラン（有料プランなど）が必要です。

## 3. 基本的な使い方

Codex CLIの主な利用方法は、対話的なセッションを開始することです。

1.  **セッション開始**: ターミナルで `codex` コマンドを実行します。
    ```bash
    codex
    ```
2.  **プロンプト入力**: セッションが開始されると、自然言語でタスクを指示できます。
    ```
    > "src/utils.ts" にある 'formatDate' 関数に、タイムゾーンを処理する機能を追加して。
    ```
3.  **対話と実行**: Codex CLIは変更案を提示したり、追加の質問をしたりします。ユーザーが承認すると、ファイルの編集やコマンドの実行を自動的に行います。スクリーンショットを渡してUIコンポーネントのコードを生成させるような使い方も可能です。

## 4. 料金体系

- **CLIツールの利用**: Codex CLI自体の利用は、特定のChatGPTプラン（例: ChatGPT Plus, Team）に含まれていると想定されます。`codex login`での認証が必要なため、アカウントの契約プランに準じます。
- **基盤モデルのAPI料金**: CLIが内部的に使用するモデル（例: GPT-4 Turbo）には、従量課金のAPI料金が設定されています。参考として、`gpt-4-turbo`モデルの料金は以下の通りです（2024年4月時点）。
    - **入力**: $10.00 / 100万トークン
    - **出力**: $30.00 / 100万トークン
- **無料枠**: OpenAI APIの新規アカウント登録時には一定の無料クレジットが付与される場合がありますが、恒久的な無料利用枠ではありません。

## 5. Gemini CLIとの比較

ご提示の参考情報（`AGENTS.md`, `config.toml`）を考慮し、shogunシステムにおける「忍び(Shinobi)」としてのGemini CLIと、「Deep Reasoning Agent」としてのCodex CLIを比較します。

| 項目 | OpenAI Codex CLI | Gemini CLI (想定) |
| :--- | :--- | :--- |
| **思想** | **対話型開発アシスタント** | **高度な分析・調査ツール** |
| **強み** | - `codex`コマンドによる対話型セッション<br>- スクリーンショット等のマルチモーダル入力<br>- ファイル編集・コマンド実行機能と安全機構（サンドボックス）<br>- ChatGPTアカウントとのシームレスな統合 | - `--include-directories`等によるファイルシステムとの高い親和性<br>- スクリプトでの利用やパイプラインへの組み込みが容易（より伝統的なCLI挙動）<br>- 大規模なコードベース全体の分析や特定情報の抽出に特化 |
| **弱み** | - 対話セッションが前提のため、単純なスクリプト処理には不向きな場合がある<br>- 料金がChatGPTのサブスクリプションに紐づく可能性 | - 対話的な開発支援よりも、一回限りの調査・分析タスクに重点が置かれている可能性がある<br>- 画像入力などのマルチモーダル機能は発展途上の可能性 |
| **モデル** | GPT-4シリーズ（ご提示の`gpt-5.2-codex`は将来のモデルを示唆） | Geminiシリーズ |

### どのような場面で使い分けるべきか

- **OpenAI Codex CLI**:
  - **用途**: 新機能の実装、複雑なバグ修正、リファクタリングなど、**一連の対話を通じて段階的にコードを修正・開発していく**場面。
  - **使い方の例**: 「（スクリーンショットを見せて）このUIをReactコンポーネントとして実装して」「このエラーメッセージを解決するためにテストを書いて、バグを修正して」

- **Gemini CLI (shinobiとして)**:
  - **用途**: 「このリポジトリ全体のアーキテクチャを分析せよ」「特定のAPIがどのように使われているか全コードから洗い出せ」といった、**大規模なコードベースに対する高度な分析・調査**が求められる場面。
  - **使い方の例**: `gemini -p "全リポジトリから 'use-deprecated-api' の使用箇所をリストアップし、代替案を提案せよ" --include-directories . > report.md`

## 6. 参考情報について

ご提示いただいた `config.toml` に記載の `model = gpt-5.2-codex` は、現在公開されているモデルよりも未来のバージョンを指すものと考えられます。しかし、Codex CLIが `AGENTS.md` にあるように「Deep Reasoning Agent」として振る舞うというコンセプトは、本ツールが目指す方向性と完全に一致しています。現状ではGPT-4系のモデルを基盤としつつ、将来的にはより強力なモデルにアップグレードされていくことが期待されます。
