# UI品質規範（UI Quality Charter）

本プロジェクトにおけるUIは、以下の規範に適合することを必須とする。
実装方式（FastAPI / Jinja2 / htmx 等）に関わらず、本規範を受け入れ基準とする。

---

## 1. 基本UX原則（Nielsen 10 Heuristics準拠）

UIは以下を満たすこと。

1. **状態の可視化**
   システムの現在状態（処理中・成功・失敗など）が明確であること。

2. **現実世界との整合性**
   用語・操作・流れがユーザーの業務や思考に沿っていること。

3. **ユーザー主導権と自由**
   戻る、キャンセル、やり直し等の操作が可能であること。

4. **一貫性と標準化**
   同じ意味の操作は同じ表現・挙動であること。

5. **エラー防止**
   ユーザーが誤りにくい設計であること。

6. **記憶より認知を優先**
   必要な情報や選択肢が画面上に提示されていること。

7. **効率性と柔軟性**
   熟練者・頻繁利用者にとっても効率的であること。

8. **最小主義デザイン**
   不要な情報や装飾を排除し、目的達成に必要な要素を優先すること。

9. **エラー回復支援**
   エラー時に「何が問題か」「どう修正するか」「次に何をすべきか」が提示されること。

10. **ヘルプと支援**
    必要に応じて説明・補足情報へアクセス可能であること。

---

## 2. アクセシビリティ原則（WCAG 2.2 準拠）

UIは以下の4原則を満たすこと。

### 2.1 知覚可能（Perceivable）

情報およびUIコンポーネントが、知覚可能な形で提供されること。

### 2.2 操作可能（Operable）

キーボード操作を含む多様な操作方法で利用可能であること。

### 2.3 理解可能（Understandable）

文言・操作・エラーメッセージが明確で理解可能であること。

### 2.4 堅牢（Robust）

異なるブラウザ・支援技術環境でも動作が維持されること。

---

## 3. AI機能を含む場合の追加原則（Human-AI Interaction）

AIによる自動生成・推論・提案等を含むUIは、以下を満たすこと。

1. **透明性**
   AIの出力内容および前提が理解可能であること。

2. **制御可能性**
   ユーザーがAIの提案を修正・拒否・再試行できること。

3. **段階的開示**
   詳細情報は必要に応じて提示されること。

4. **失敗時設計**
   AIが誤った場合でも復旧可能な導線があること。

---

## 4. 大量データ・ナビゲーション原則（cmd_296 忍び調査に基づく追加）

大量データを扱うリスト画面およびスクロールが発生するページに適用する。

### 4.1 主要ナビゲーションとアクションは常にアクセス可能であること

* **基準A**: ページスクロール時、主要なグローバルヘッダは常に画面上部に固定表示されること（`position: sticky; top: 0`）。
* **基準B**: ページ全体の主要アクション（保存、決定など）や、複数アイテムを選択した際のバルクアクションは、画面上部または下部に固定表示されるアクションバー内に配置すること。

### 4.2 大量のリスト項目は、管理可能な単位に分割して提示すること

* **基準A**: デフォルトで20件以上のリスト項目が存在する可能性がある場合、全件を一度に表示せず、ページネーションを実装すること。
* **基準B**: ページネーションには、現在の表示範囲と総件数を示すテキスト（例: 「93件中 1-20件を表示」）を必ず含めること。

### 4.3 大量のリストは、ユーザーが効率的に絞り込み・並べ替えられること

* **基準A**: 50件以上のデータを持つ可能性があるリストには、必ずキーワード検索、フィルタリング、および列ごとのソート機能を提供すること。

### 4.4 長いページでは、主要なナビゲーションポイントへのショートカットを提供すること

* **基準A**: 3画面以上のスクロールが必要なページには、「トップへ戻る」ボタンを画面右下に配置すること。

---

## 5. 適合義務

* 上記規範（第1〜4章）はすべてのUI変更に適用される。
* 本規範に適合しない実装はマージ不可とする。
* 適合困難な場合は、理由および代替案を設計レビューにて提示すること。

---

## 参考文献

* Nielsen Norman Group – Ten Usability Heuristics
  https://www.nngroup.com/articles/ten-usability-heuristics/

* W3C – Web Content Accessibility Guidelines (WCAG) 2.2
  https://www.w3.org/TR/WCAG22/

* Microsoft – Guidelines for Human-AI Interaction
  https://www.microsoft.com/en-us/research/wp-content/uploads/2019/01/Guidelines-for-Human-AI-Interaction-camera-ready.pdf
